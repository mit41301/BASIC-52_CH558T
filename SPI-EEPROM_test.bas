100 REM SPI-EEPROM 25LC040A Test Program
200 REM
300 HIGH = 1
400 LOW = 0
500 SPICS  HIGH
600 
700 Rcmd = 03h
800 Wcmd = 02h
900 Wecmd = 06h
1000 
1100 SPISTART 32
1200 
1300 J = 10
1400 
1500 REM EEPROM WRITE
1600 REM
1700 For Iw = 0 To 511 Step 16
1800 
1900   SPICS  LOW
2000   SPIPUT Wecmd
2100   SPICS  HIGH
2200 
2300   Iwh = int(Iw/256)
2400   Iwh = Iwh * 8
2500   Iwh = Wcmd .or. Iwh
2600   Iwl = Iw .and. 00FFh
2700 
2800   SPICS  LOW
2900   SPIPUT Iwh
3000   SPIPUT Iwl
3100 
3200   For I = 0 To 15
3300     J = J .and. 00FFh
3400     SPIPUT J
3500     J = J + 1
3600   Next I
3700 
3800   SPICS  HIGH
3900 
3910 REM WAIT FOR WRITE PROCESS END
3920 REM
3930 FOR I=1 to 100 : NEXT I
3940
4000 Next Iw
4100 
4200 REM EEPROM READ
4300 REM
4400 For Iw = 0 To 511 Step 16
4500 
4600   Iwh = int(Iw/256)
4700   Iwh = Iwh * 8
4800   Iwh = Rcmd .or. Iwh
4900   Iwl = Iw .and. 00FFh
5000 
5100   Ph1. Iw,
5200   PRINT ":",
5300 
5400   SPICS  LOW
5500   SPIPUT Iwh
5600   SPIPUT Iwl
5700 
5800   FOR I = 0 TO 15
5900     SPIGET J
6000     Ph0. J,
6100   NEXT I
6200 
6300   SPICS  HIGH
6400 
6500   PRINT
6600 
6700 next Iw
6800 
6900 End
