100 REM MCP3002 Test Program
200 REM
300 HIGH = 1
400 LOW = 0
500 SPICS  HIGH
600 
700 DIM CMD(2), RESP(2)
800 CMD(0) = 68h
900 CMD(1) = 00h
1000 
1100 SPISTART 96 : REM Clock 500KHz
1200 
1300 For I = 0 To 100
1400   SPICS LOW
1500   SPIROT (CMD(0)) RESP(0)
1600   SPIROT (CMD(1)) RESP(1)
1700   SPICS HIGH
1800   AD =  RESP(0) * 256 + RESP(1)
1900   AD = AD .and. 03FFh
2000   V = AD * 5.0 / 1023
2100   PRINT AD, V
2200   FOR K=1 TO 10000 :  NEXT K
2300 NEXT I
2400
2500 End
